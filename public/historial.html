<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HRS - Historial de Facturas</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(to bottom, #f8f9fc 0%, #f0f2f8 100%);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            font-size: 0.95rem;
            min-height: 100vh;
        }

        /* Header */
        .faja-logo {
            height: 80px;
            background-color: #ffffff;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            border-bottom: 1px solid #eee;
        }

        .faja-logo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
            animation: none !important;
            transition: none !important;
        }

        .header-fino-ancho {
            background-color: #ffffff;
            border-bottom: 4px solid #00cc6e !important;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            padding: 12px 0 !important;
        }

        .header-fino-ancho h1 {
            color: #212529;
            font-weight: 800;
            font-size: 1.8rem;
            letter-spacing: 1px;
        }

        /* Contenedor principal */
        .container-main {
            margin-top: 30px;
            margin-bottom: 30px;
        }

        /* Cards */
        .card {
            border: none;
            border-radius: 16px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            background: white;
            border-top: 3px solid transparent;
        }

        .card:hover {
            box-shadow: 0 12px 32px rgba(0, 0, 0, 0.12);
        }

        .card h6 {
            color: #333;
            font-weight: 700;
            border-bottom: 2px solid #f0f0f0 !important;
        }

        /* Botones */
        .btn-success,
        .btn-dark {
            border-radius: 10px;
            font-weight: 700;
            transition: all 0.3s ease;
            border: none;
        }

        .btn-excel {
            background: linear-gradient(135deg, #1d6f42 0%, #0f5233 100%);
            box-shadow: 0 8px 16px rgba(29, 111, 66, 0.25);
        }

        .btn-excel:hover {
            background: linear-gradient(135deg, #0f5233 0%, #1d6f42 100%);
            transform: translateY(-2px);
            box-shadow: 0 12px 24px rgba(29, 111, 66, 0.35);
            color: white;
        }

        .btn-volver {
            background: linear-gradient(135deg, #00cc6e 0%, #00b85c 100%);
            box-shadow: 0 8px 16px rgba(0, 204, 110, 0.25);
        }

        .btn-volver:hover {
            background: linear-gradient(135deg, #00b85c 0%, #00cc6e 100%);
            transform: translateY(-2px);
            box-shadow: 0 12px 24px rgba(0, 204, 110, 0.35);
            color: white;
        }

        /* Tabla */
        .contenedor-tabla-fija {
            min-height: 400px;
            background: white;
            border-radius: 14px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
        }

        .table-responsive {
            border-radius: 14px;
            overflow: hidden;
        }

        .table {
            margin-bottom: 0;
        }

        .table thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .table thead th {
            border: none;
            font-weight: 700;
            padding: 12px 10px;
            font-size: 0.8rem;
        }

        .table tbody tr {
            transition: all 0.2s;
            border-bottom: 1px solid #f0f0f0;
        }

        .table tbody tr:hover {
            background-color: #f8f9fc;
        }

        .table tbody td {
            padding: 10px;
            font-size: 0.85rem;
        }

        /* Botones de acciones */
        .btn-action {
            padding: 5px 8px;
            font-size: 0.75rem;
            margin: 2px;
        }

        /* Filtros */
        .filtros-section {
            background: white;
            border-radius: 14px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
        }

        .filtros-section h6 {
            color: #333;
            font-weight: 700;
            margin-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 10px;
        }

        /* Barra de acciones superior */
        .acciones-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .faja-abajo {
            margin-top: 40px;
            margin-bottom: 0;
        }

        /* Estado badge */
        .badge-factura {
            background-color: #e3f2fd;
            color: #1976d2;
            padding: 5px 10px;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 700;
        }

        .badge-recibo {
            background-color: #f3e5f5;
            color: #7b1fa2;
            padding: 5px 10px;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 700;
        }
    </style>
</head>

<body>

  <!-- ========================= -->
  <!-- HEADER LOGO -->
  <!-- ========================= -->
    <div class="container-fluid p-0">
        <div class="faja-logo">
            <img src="images/LOGO-FACTURA-1.png" alt="HRS Logo Banner">
        </div>
    </div>


  <!-- ========================= -->
  <!-- HEADER TITULO -->
  <!-- ========================= -->
  <nav class="navbar navbar-light bg-dark py-3 shadow-sm">
    <div class="container">
      <h1 class="navbar-brand fw-bold text-white mb-0">
        üìã HISTORIAL DE FACTURAS
      </h1>
    </div>
  </nav>


  <!-- ========================= -->
  <!-- CONTENEDOR PRINCIPAL -->
  <!-- ========================= -->
  <div class="container container-main my-4">


    <!-- ========================= -->
    <!-- FILTROS -->
    <!-- ========================= -->
    <div class="filtros-section p-4 rounded-4 shadow-sm bg-white border mb-4">

      <div class="d-flex align-items-center mb-3">
        <h6 class="fw-bold mb-0">üîç FILTROS</h6>
      </div>

      <div class="row g-3 align-items-end">

        <!-- Cliente -->
        <div class="col-md-4">
          <label class="form-label small fw-bold">Cliente</label>
          <input
            type="text"
            class="form-control form-control-sm"
            id="filtroCliente"
            placeholder="Buscar cliente..."
            onkeyup="aplicarFiltros()"
          >
        </div>

        <!-- Tipo -->
        <div class="col-md-2">
          <label class="form-label small fw-bold">Tipo</label>
          <select
            class="form-select form-select-sm"
            id="filtroTipo"
            onchange="aplicarFiltros()"
          >
            <option value="">Todos</option>
            <option value="Factura">Factura</option>
            <option value="Recibo">Recibo</option>
          </select>
        </div>

        <!-- Mes -->
        <div class="col-md-3">
          <label class="form-label small fw-bold">Mes</label>
          <input
            type="month"
            class="form-control form-control-sm"
            id="filtroMes"
            onchange="aplicarFiltros()"
          >
        </div>

        <!-- Bot√≥n Limpiar -->
        <div class="col-md-3">
          <button
            class="btn btn-outline-dark btn-sm w-100 d-flex align-items-center justify-content-center gap-2"
            onclick="limpiarFiltros()"
          >
            üßπ Limpiar filtros
          </button>
        </div>

      </div>
    </div>


    <!-- ========================= -->
    <!-- TABLA FACTURAS -->
    <!-- ========================= -->
    <div class="card p-4 rounded-4 shadow-sm border-0 mb-4">

      <div class="d-flex justify-content-between align-items-center border-bottom pb-2 mb-3">
        <h6 class="fw-bold mb-0">üìÑ Listado de Facturas y Recibos</h6>
      </div>

      <div class="table-responsive">
        <table class="table table-hover table-sm align-middle mb-0" style="font-size: 0.85rem;">

          <thead class="table-dark">
            <tr>
              <th>N¬∞</th>
              <th>Tipo</th>
              <th>Cliente</th>
              <th>Fecha</th>
              <th>Mes</th>
              <th>Total</th>
              <th class="text-center">Acciones</th>
            </tr>
          </thead>

          <tbody id="facturasHistorialBody">
            <tr>
              <td colspan="7" class="text-center text-muted py-4">
                <small>No hay facturas registradas</small>
              </td>
            </tr>
          </tbody>

        </table>
      </div>


      <!-- ========================= -->
      <!-- BOTONES INFERIORES -->
      <!-- ========================= -->
      <div class="row mt-4 g-3 align-items-end">

        <!-- Volver -->
        <div class="col-md-4">
          <a
            href="/"
            class="btn btn-dark btn-sm w-100 py-2 fw-bold shadow-sm"
          >
            ‚Üê VOLVER
          </a>
        </div>

        <!-- Acciones -->
        <div class="col-md-8">
          <div class="d-flex justify-content-md-end gap-2 flex-wrap">

            <button
              class="btn btn-success btn-sm px-4 py-2 shadow-sm"
              onclick="exportarHistorialExcel()"
            >
              üìä EXCEL
            </button>

            <button
              class="btn btn-danger btn-sm px-4 py-2 shadow-sm"
              onclick="abrirConfirmacionBorrar()"
            >
              üóëÔ∏è LIMPIAR TODO
            </button>

          </div>
        </div>

      </div>

    </div>


    <!-- ========================= -->
    <!-- ESTAD√çSTICAS -->
    <!-- ========================= -->
    <div class="row g-3 mb-4">

      <div class="col-md-3">
        <div class="card p-4 rounded-4 shadow-sm border-0 text-center h-100">
          <h6 class="text-muted small mb-2">TOTAL FACTURAS</h6>
          <h2 class="fw-bold text-primary mb-0" id="statsFacturas">0</h2>
        </div>
      </div>

      <div class="col-md-3">
        <div class="card p-4 rounded-4 shadow-sm border-0 text-center h-100">
          <h6 class="text-muted small mb-2">TOTAL RECIBOS</h6>
          <h2 class="fw-bold text-success mb-0" id="statsRecibos">0</h2>
        </div>
      </div>

      <div class="col-md-3">
        <div class="card p-4 rounded-4 shadow-sm border-0 text-center h-100">
          <h6 class="text-muted small mb-2">MONTO TOTAL</h6>
          <h2 class="fw-bold mb-0" id="statsMontoTotal">$ 0</h2>
        </div>
      </div>

      <div class="col-md-3">
        <div class="card p-4 rounded-4 shadow-sm border-0 text-center h-100">
          <h6 class="text-muted small mb-2">REGISTROS</h6>
          <h2 class="fw-bold text-info mb-0" id="statsTotal">0</h2>
        </div>
      </div>

    </div>

  </div>


  <!-- ========================= -->
  <!-- FAJA INFERIOR -->
  <!-- ========================= -->
  <div class="container-fluid p-0 mt-4">
    <img
      src="images/FAJA-ABAJO-HRS.png"
      class="w-100"
      style="height: 55px; object-fit: cover;"
    >
  </div>


  <!-- ========================= -->
  <!-- MODAL CONFIRMACI√ìN -->
  <!-- ========================= -->
  <div class="modal fade" id="confirmarBorrarModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content p-4 text-center shadow border-0 rounded-4">

        <div class="fs-1 mb-2">‚ùì</div>
        <h4 class="fw-bold">¬øBorrar todo el historial?</h4>
        <p class="text-muted small">Esta acci√≥n no se puede deshacer</p>

        <div class="d-flex justify-content-center gap-2 mt-3">
          <button class="btn btn-light px-4" data-bs-dismiss="modal">
            Cancelar
          </button>
          <button class="btn btn-danger px-4" onclick="confirmarBorrarHistorial()">
            S√≠, borrar todo
          </button>
        </div>

      </div>
    </div>
  </div>


  <!-- ========================= -->
  <!-- MODAL ALERTA -->
  <!-- ========================= -->
  <div class="modal fade" id="alertaModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-sm">
      <div class="modal-content text-center p-4 border-0 shadow rounded-4">

        <div id="modalIcono" class="fs-2 mb-2"></div>
        <h5 id="modalTitulo" class="fw-bold"></h5>
        <p id="modalMensaje" class="text-muted small mb-0"></p>

      </div>
    </div>
  </div>


  <!-- ========================= -->
  <!-- SCRIPTS -->
  <!-- ========================= -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="historial.js"></script>

</body>
</html>
